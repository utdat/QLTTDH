<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.quanlytrungtamdayhoc.mapper.SubjectMapper">
	
	<resultMap id="SubjectMapper" type="com.quanlytrungtamdayhoc.dbo.Subject">
		<id property="subId" column="SUB_ID"/>
		<result property="subName" column="SUB_NAME"/>
		<result property="subStartdate" column="SUB_STARTDATE"/>
		<result property="subSchedule" column="SUB_SCHEDULE"/>
		<result property="subRoom" column="SUB_ROOM"/>
		<result property="subTuition" column="SUB_TUITION"/>
		
		<association property="teacher" javaType="com.quanlytrungtamdayhoc.dbo.Teacher">
			<id property="teaId" column="TEA_ID"/>
			<result property="teaEmail" column="TEA_EMAIL"/>
			<result property="teaName" column="TEA_NAME"/>
			<result property="teaPhone" column="TEA_PHONE"/>
			<result property="teaAddress" column="TEA_ADDRESS"/>
			<result property="teaGender" column="TEA_GENDER"/>
			<result property="teaBirthdate" column="TEA_BIRTHDATE"/>
			<result property="teaHiredate" column="TEA_HIREDATE"/>
			<result property="teaSchool" column="TEA_SCHOOL"/>
			<result property="teaAvatar" column="TEA_AVATAR"/>
			<result property="teaSalaryrate" column="TEA_SALARYRATE"/>
		</association>
	</resultMap>
	
	<select id="getTeacherSubject" resultMap="SubjectMapper" parameterType="map">
		SELECT *
		FROM SUBJECTS
		WHERE SUBJECTS.TEA_ID = #{teaId}
	</select>
	
	<select id="listStudentSubject" resultMap="SubjectMapper" parameterType="map">
		SELECT *
		FROM SUBJECTS 
        JOIN TEACHERS ON SUBJECTS.TEA_ID = TEACHERS.TEA_ID
 		WHERE SUB_ID NOT IN (SELECT SUB_ID FROM STUDENT_SCORES WHERE
							 STUDENT_SCORES.STU_ID = #{stuId}) 
		ORDER BY SUB_STARTDATE
	</select>
	
</mapper>